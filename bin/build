#!/bin/bash

set -e

PLATFORM=${1:-sdl3}

usage() {
    echo "Usage: $0 [sdl3]"
    echo "  sdl3:    Build with SDL3"
    exit 1
}

if [[ "$1" == "-h" || "$1" == "--help" ]]; then
    usage
fi

if [[ "$PLATFORM" != "sdl3" ]]; then
    echo "Error: Invalid platform '$PLATFORM'"
    usage
fi

echo "Building for platform: $PLATFORM"

mkdir -p ./target
pushd ./target/

case $PLATFORM in
    "sdl3")
        echo "Compiling SDL3 version..."
        bear -- c++ ../code/sdl3_handmade.cpp -o handmade -g `pkg-config sdl3 --cflags --libs` -Wall
        ;;
esac

popd

echo "Build completed successfully!"
